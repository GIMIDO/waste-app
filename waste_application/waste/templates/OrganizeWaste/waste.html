{% extends 'base/base.html' %}
  {% block content %}
    <div class="" style="margin-bottom: 150px;">
      <form class="" method="get" action="{% url 'organize-waste-main' %}">
      <p class="fs-4 fw-bold mb-2">Поиск</p>

      <div class="d-flex justify-content-start">

        <div class="input-group wform me-2">
          <label class="input-group-text">Источник</label>
          <select name="type" type="text" class="form-select">
            <option value="{{ page_data.e_s }}" selected hidden>{{ page_data.e_s }}</option>
            <option value="Элеватор">Элеватор</option>
            <option value="Мельница">Мельница</option>
            <option value="Крупозавод">Крупозавод</option>
            <option value="Фасовка">Фасовка</option>
          </select>
        </div>

        <div class="input-group wform me-2">
          <label class="input-group-text">Год</label>
          <input type="number" name="year" class="form-control" placeholder="Год" value="{{ page_data.year }}">
        </div>

        <div class="input-group wform">
          <label class="input-group-text">Квартал</label>
          <select name="quarter" type="text" class="form-select">
            <option value="{{ page_data.quarter }}" selected hidden>{{ page_data.quarter }}</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
        </div>

      </div>

        <input class="btn btn-primary mt-2" type="submit" value="Найти" />
      </form>

      <hr />

      <p class="fs-4"><strong>{{ page_data.e_s }}</strong>, <strong>{{ page_data.quarter }}</strong> квартал, <strong>{{ page_data.year }}</strong> год</p>

    <table class="table table-bordered table-hover caption-top">
      <caption class="text-end">Сохраненные записи</caption>
      <thead>
        <tr class="text-center">
          <th>№ ист.</th>
          <th>№ АУ или ПТУ</th>
          <th>Вредное вещество</th>

          <th>{{ page_data.months.1 }}</th>
          <th>{{ page_data.months.2 }}</th>
          <th>{{ page_data.months.3 }}</th>

          <th>Всего</th>

          <th>М, г/с</th>
          <th>G, т/год</th>
          <th style="width: 6%;"></th>
        </tr>
      </thead>

      <tbody>
          {% for elem in table_data.data %}

            <tr class="text-center align-middle">
              <td>{{ elem.emission_source_number }}</td>
              <td>{{ elem.au_ptu_number }}</td>
              <td>{{ elem.harmful_substance_name }}</td>

              <td>{{ elem.first_month }}</td>
              <td>{{ elem.second_month }}</td>
              <td>{{ elem.third_month }}</td>
              <td>{{ elem.all }}</td>

              <td>{{ elem.M }}</td>
              <td>{{ elem.G }}</td>
              <td style="padding-left: 0; padding-right: 0;">
                <a href="{% url 'organize-waste-update' page_data.e_s page_data.year page_data.quarter elem.pk %}" class="btn btn-warning btn-sm me-1">Изм</a>
                <a href="{% url 'organize-waste-delete' elem.pk %}" class="btn btn-danger btn-sm">Удл</a>
              </td>

            </tr>
          {% endfor %}
      </tbody>
    </table>

    <table class="table table-bordered table-hover mt-3 mb-5 text-center w-50 caption-top">
      <caption class="text-end">Квартальный расчет</caption>
      <thead>
        <tr class=" align-middle">
          <th></th>
        {% for item in table_data.h_s_types %}
            <th>{{ item }}</th>
            {% endfor %}
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>G [т/год]</td>
          {% for elem in table_data.calc_data %}
          <td>{{ elem }}</td>
          {% endfor %}
        </tr>
      </tbody>
    </table>

    <div class="fixed-bottom" style="background: #fff; ">
      <hr style="padding: 0; margin: 0;" class="">
      <div class="two-items" style="display: flex; justify-content: space-between;">
        <p class="fs-4 ms-5 my-2">Организованные | <strong>{{ page_data.e_s }}</strong>, <strong>{{ page_data.quarter }}</strong> квартал, <strong>{{ page_data.year }}</strong> год</p>
        <div class="mx-5 my-2">
          <a href="{% url 'organize-waste-create' page_data.e_s page_data.year page_data.quarter %}" class="btn btn-success">Добавить в эту таблицу</a>
          <a href="{% url 'excel-download' page_data.e_s page_data.year page_data.quarter %}" class="btn btn-primary">Скачать в Excel</a>
        </div>
      </div>

    </div>
  </div>

    {% endblock content %}
  </body>
</html>
